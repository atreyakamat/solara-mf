"use strict";(()=>{var e={};e.id=615,e.ids=[615],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},48891:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.r(t),n.d(t,{originalPathname:()=>m,patchFetch:()=>u,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>c});var a=n(49303),r=n(88716),i=n(60670),l=n(78661),s=e([l]);l=(s.then?(await s)():s)[0];let d=new a.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/funds/route",pathname:"/api/funds",filename:"route",bundlePath:"app/api/funds/route"},resolvedPagePath:"/Users/atreyakamat/Projects/solara-mf/src/app/api/funds/route.ts",nextConfigOutput:"",userland:l}),{requestAsyncStorage:f,staticGenerationAsyncStorage:c,serverHooks:p}=d,m="/api/funds/route";function u(){return(0,i.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:c})}o()}catch(e){o(e)}})},415:(e,t,n)=>{n.r(t),n.d(t,{conversations:()=>p,funds:()=>g,fundsRelations:()=>v,insertConversationSchema:()=>h,insertFundSchema:()=>A,insertMessageSchema:()=>y,insertPortfolioItemSchema:()=>x,insertPortfolioSchema:()=>P,messages:()=>m,portfolioItems:()=>R,portfolioItemsRelations:()=>L,portfolios:()=>N,portfoliosRelations:()=>_});var o=n(7561),a=n(95961),r=n(72140),i=n(12941),l=n(43050),s=n(28680),u=n(1575),d=n(23861),f=n(11613),c=n(62315);let p=(0,o.af)("conversations",{id:(0,a.eP)("id").primaryKey(),title:(0,r.fL)("title").notNull(),createdAt:(0,u.AB)("created_at").default((0,c.i6)`CURRENT_TIMESTAMP`).notNull()}),m=(0,o.af)("messages",{id:(0,a.eP)("id").primaryKey(),conversationId:(0,i._L)("conversation_id").notNull().references(()=>p.id,{onDelete:"cascade"}),role:(0,r.fL)("role").notNull(),content:(0,r.fL)("content").notNull(),createdAt:(0,u.AB)("created_at").default((0,c.i6)`CURRENT_TIMESTAMP`).notNull()}),h=(0,d.fC)(p).omit({id:!0,createdAt:!0}),y=(0,d.fC)(m).omit({id:!0,createdAt:!0}),g=(0,o.af)("funds",{id:(0,a.eP)("id").primaryKey(),name:(0,r.fL)("name").notNull(),amc:(0,r.fL)("amc").notNull(),category:(0,r.fL)("category").notNull(),subCategory:(0,r.fL)("sub_category").notNull(),riskLevel:(0,r.fL)("risk_level").notNull(),rating:(0,i._L)("rating").notNull(),nav:(0,l.uR)("nav").notNull(),navChange:(0,l.uR)("nav_change").notNull(),minSip:(0,i._L)("min_sip").notNull(),expenseRatio:(0,l.uR)("expense_ratio").notNull(),exitLoad:(0,r.fL)("exit_load").notNull(),aum:(0,l.uR)("aum").notNull(),fundManager:(0,r.fL)("fund_manager").notNull(),return1y:(0,l.uR)("return_1y").notNull(),return3y:(0,l.uR)("return_3y").notNull(),return5y:(0,l.uR)("return_5y").notNull(),alpha:(0,l.uR)("alpha"),beta:(0,l.uR)("beta"),sharpe:(0,l.uR)("sharpe"),sortino:(0,l.uR)("sortino"),stdDev:(0,l.uR)("std_dev"),benchmark:(0,r.fL)("benchmark"),holdings:(0,s.JB)("holdings"),navHistory:(0,s.JB)("nav_history")}),N=(0,o.af)("portfolios",{id:(0,a.eP)("id").primaryKey(),name:(0,r.fL)("name").notNull().default("My Portfolio"),createdAt:(0,u.AB)("created_at").defaultNow()}),R=(0,o.af)("portfolio_items",{id:(0,a.eP)("id").primaryKey(),portfolioId:(0,i._L)("portfolio_id").notNull(),fundId:(0,i._L)("fund_id").notNull(),amount:(0,l.uR)("amount").notNull(),allocation:(0,i._L)("allocation").default(0),mode:(0,r.fL)("mode").notNull()}),v=(0,f.lE)(g,({many:e})=>({portfolioItems:e(R)})),_=(0,f.lE)(N,({many:e})=>({items:e(R)})),L=(0,f.lE)(R,({one:e})=>({portfolio:e(N,{fields:[R.portfolioId],references:[N.id]}),fund:e(g,{fields:[R.fundId],references:[g.id]})})),A=(0,d.fC)(g).omit({id:!0}),P=(0,d.fC)(N).omit({id:!0,createdAt:!0}),x=(0,d.fC)(R).omit({id:!0})},78661:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.r(t),n.d(t,{GET:()=>d});var a=n(87070),r=n(75748),i=n(415),l=n(62315),s=n(57745),u=e([r]);async function d(e){try{let t;let{searchParams:n}=new URL(e.url),o=n.get("search"),u=n.get("category"),d=n.get("riskLevel"),f=n.get("minRating"),c=r.db.select().from(i.funds),p=[];return o&&p.push((0,l.i6)`(${i.funds.name} ILIKE ${`%${o}%`} OR ${i.funds.amc} ILIKE ${`%${o}%`})`),u&&"All"!==u&&p.push((0,s.eq)(i.funds.category,u)),d&&"All"!==d&&p.push((0,s.eq)(i.funds.riskLevel,d)),f&&p.push((0,l.i6)`${i.funds.rating} >= ${Number(f)}`),t=p.length>0?await c.where(l.i6.join(p,(0,l.i6)` AND `)):await c,a.NextResponse.json(t)}catch(e){return console.error("Error fetching funds:",e),a.NextResponse.json({message:"Failed to fetch funds"},{status:500})}}r=(u.then?(await u)():u)[0],o()}catch(e){o(e)}})},75748:(e,t,n)=>{n.a(e,async(e,o)=>{try{n.d(t,{db:()=>d});var a=n(88029),r=n(8678),i=n(415),l=e([r,a]);[r,a]=l.then?(await l)():l;let{Pool:s}=r.default,u=null,d=new Proxy({},{get:(e,t)=>(function(){if(!u){let e=new s({connectionString:process.env.DATABASE_URL});u=(0,a.tS)(e,{schema:i})}return u})()[t]});o()}catch(e){o(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),o=t.X(0,[276,376,972],()=>n(48891));module.exports=o})();